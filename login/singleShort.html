<head>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
  <style>
    /* video {
      background-color: black
    } */
  </style>
</head>

//studyRecord(vidSources[1], vidSources[2], vidSources[3], vidSources[4])
<iframe id="myframe" src="" width="1920" height="1028" frameborder="0" allow="autoplay; fullscreen;"></iframe>
<!-- <video height="100%" width="100%" src="" id="myvideo" autoplay="false" controls="true" playsinline></video> -->
<script>

  var vidSources = [
  ];
  const loc = ""
  //const loc = "https://www.eplat.co.kr/assets/img/online_study_room/v3/"
  // https://jsfiddle.net/bnzqkpza/
  const searchParams = new URLSearchParams(location.search);

  for (const param of searchParams) {
    console.log(param);
    vidSources.push(loc + param[1])
  }

  //studyRecord(vidSources[1], vidSources[2], vidSources[3], vidSources[4])
  $("#myframe").src = vidSources[0];
  studyRecord(vidSources[1], vidSources[2], vidSources[3], vidSources[4]);

  //var vidElement = document.getElementById('myvideo');
  window.open(vidSources[0], '_self');
  //window.location.href = vidSources[0];
  //vidElement.src = vidSources[0];
  //vidElement.play();
  //playVideo();

  // async function playVideo() {
  //   const video = document.getElementById('myvideo');

  //   try {
  //     await video.play();
  //   } catch (error) {
  //     console.error('Autoplay failed:', error);
  //   }
  // }

  // vidElement.addEventListener('ended', function (e) {
  //   video.pause();
  //   if (Number(vidElement.currentTime) > 10)
  //     studyRecord(vidSources[1], vidSources[2], vidSources[3], vidSources[4])

  // });

  // window.onbeforeunload = function () {
  //   if (Number(vidElement.currentTime) > 10)
  //     studyRecord(vidSources[1], vidSources[2], vidSources[3], vidSources[4])
  // }

  function studyRecord(id, uid, vol, stp) {
    //alert('anchr click!');
    // var data = {id: "admin", step: "S1", volume: "1", uid: "w1_1"};
    var data = { id: id, step: stp, volume: vol, uid: "#" + uid };
    $.ajax({
      url: "SstudyRecord.php",
      type: "POST",
      dataType: "json",
      data: data,
      async: true,
      success: function (res) {
        console.log(res)
      },
      error: function (jqXFR, textStatus, errorThrown) {
        if (textStatus == "error") {
          alert(loc + ' ' + textStatus);
        }
      }
    });
  }
  // document.getElementById('myvideo').addEventListener('click', function () {
  //   this.play();
  // }); 
</script>
</body>